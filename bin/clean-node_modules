#!/usr/bin/env bash
[[ "$1" ]] && cd "$1"

echo "Cleaning node_modules from $(pwd)..."

# collect parent node_modules folders
mapfile -t node_modules < <(find . | grep node_modules$ | grep -v "/node_modules.*/node_modules")

if (( ${#node_modules[@]} )); then
  printf 'deleting %s\n' "${node_modules[@]}"
  rm -rf "${node_modules[@]}"
else
  echo "Already clean"
fi

